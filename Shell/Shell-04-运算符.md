#  Shell 运算符

Shell 和其他编程语言一样，支持多种运算符，包括：

- 算数运算符
- 关系运算符
- 布尔运算符
- 字符串运算符
- 文件测试运算符

原生bash不支持简单的数学运算，但是可以通过其他命令来实现，例如 awk 和 expr，expr 最常用。expr 是一款表达式计算工具，使用它能完成表达式的求值操作。

例如，两个数相加(**注意使用的是反引号 ` 而不是单引号 '**)：

```bash
#!/bin/bash

val=`expr 2 + 2`
echo "两数之和为 : $val"
```

注意：

- 表达式和运算符之间要有空格，例如 `2+2` 是不对的，必须写成 `2 + 2`。
- 完整的表达式要被 \`\` 包含，注意这个字符不是常用的单引号，在 Esc 键下边。

###  算术运算符

常用的算数运算符：

| 运算符 | 说明                                |
| ------ | ----------------------------------- |
| +      | 加                                  |
| -      | 减                                  |
| *      | 乘                                  |
| /      | 除                                  |
| %      | 取余                                |
| =      | 赋值                                |
| ==     | 相等。比较两个数字，相同返回 true   |
| !=     | 不相等。比较两个数字，相同返回 true |

示例代码：

```bash
#!/bin/bash

a=10
b=20

val=`expr $a + $b`
echo "a + b : $val"

val=`expr $a \* $b`
echo "a * b : $val"

if [ $a == $b ]
then
   echo "a 等于 b"
fi
```

> **注意：**
>
> - 条件表达式要放在方括号之间，并且要有空格，例如: **[$a==$b]** 是错误的，必须写成 **[ $a == $b ]**。
> - 乘号 (*) 前边必须加反斜杠 (\\) 才能实现乘法运算；
> - 在 MAC 中 shell 的 expr 语法是：**$((表达式))**，此处表达式中的 "*" 不需要转义符号 "\" 。

###  关系运算符

关系运算符只支持数字，不支持字符串，除非字符串的值是数字。

常用的关系运算符：

| 运算符 | 说明                                          |
| ------ | --------------------------------------------- |
| -eq    | 检测两数是否相等，相等返回 true               |
| -ne    | 检测两数是否不相等，不相等返回 true           |
| -gt    | 检测左边的数是否大于右边的，若是返回 true     |
| -lt    | 检测左边的数是否小于右边的，若是返回 true     |
| -ge    | 检测左边的数是否大于等于右边的，若是返回 true |
| -le    | 检测左边的数是否小于等于右边的，若是返回 true |

示例代码：

```bash
#!/bin/bash

a=10
b=20

if [ $a -eq $b ]
then
   echo "$a -eq $b : a 等于 b"
else
   echo "$a -eq $b: a 不等于 b"
fi
```

###  布尔运算符

常用的布尔运算符：

| 运算符 | 说明         |
| ------ | ------------ |
| !      | 非运算，取反 |
| -o     | 或运算       |
| -a     | 与运算       |

示例代码：

```bash
#!/bin/bash

a=10
b=20

if [ $a -lt 100 -a $b -gt 15 ]
then
   echo "$a 小于 100 且 $b 大于 15 : 返回 true"
else
   echo "$a 小于 100 且 $b 大于 15 : 返回 false"
fi
```

###  逻辑运算符

| 运算符 | 说明       |
| ------ | ---------- |
| &&     | 逻辑的 AND |
| \|\|   | 逻辑的 OR  |

示例代码：

```bash
#!/bin/bash

a=10
b=20

if [[ $a -lt 100 && $b -gt 100 ]]
then
   echo "返回 true"
else
   echo "返回 false"
fi
```

###  字符串运算符

常用的字符串运算符：

| 运算符 | 说明                                     |
| ------ | ---------------------------------------- |
| =      | 检测两个字符串是否相等，相等返回 true    |
| !=     | 检测两个字符串是否相等，不相等返回 true  |
| -z     | 检测字符串长度是否为 0，为 0 返回 true   |
| -n     | 检测字符串长度是否为 0，不为 0 返回 true |
| str    | 检测字符串是否为空，不为空返回 true      |

示例代码：

```bash
#!/bin/bash

a="abc"
b="efg"

# 注意空格
if [ $a = $b ]
then
   echo "$a = $b : a 等于 b"
else
   echo "$a = $b: a 不等于 b"
fi

if [ -z $a ]
then
   echo "-z $a : 字符串长度为 0"
else
   echo "-z $a : 字符串长度不为 0"
fi

if [ $a ]
then
   echo "$a : 字符串不为空"
else
   echo "$a : 字符串为空"
fi
```

###  文件测试运算符

文件测试运算符用于检测 Unix 文件的各种属性。属性检测描述如下：

| 操作符  | 说明                                                         |
| ------- | ------------------------------------------------------------ |
| -b file | 检测文件是否是块设备文件，如果是，则返回 true                |
| -c file | 检测文件是否是字符设备文件，如果是，则返回 true              |
| -d file | 检测文件是否是目录，如果是，则返回 true                      |
| -f file | 检测文件是否是普通文件（既不是目录，也不是设备文件），如果是，则返回 true |
| -g file | 检测文件是否设置了 SGID 位，如果是，则返回 true              |
| -k file | 检测文件是否设置了粘着位(Sticky Bit)，如果是，则返回 true    |
| -p file | 检测文件是否是有名管道，如果是，则返回 true                  |
| -u file | 检测文件是否设置了 SUID 位，如果是，则返回 true              |
| -r file | 检测文件是否可读，如果是，则返回 true                        |
| -w file | 检测文件是否可写，如果是，则返回 true                        |
| -x file | 检测文件是否可执行，如果是，则返回 true                      |
| -s file | 检测文件是否为空（文件大小是否大于 0），不为空返回 true      |
| -e file | 检测文件（包括目录）是否存在，如果是，则返回 true            |

示例代码：

```bash
#!/bin/bash

file="/var/www/runoob/test.sh"

if [ -e $file ]
then
   echo "文件存在"
else
   echo "文件不存在"
fi

if [ -r $file ]
then
   echo "文件可读"
else
   echo "文件不可读"
fi
```



> 参考链接：http://www.runoob.com/linux/linux-shell-basic-operators.html